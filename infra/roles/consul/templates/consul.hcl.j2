datacenter = "us-east-2"
data_dir = "/var/lib/consul/data"
server = true
enable_syslog = true
ui_config {
  enabled = true
}

# TLS Encryption
ca_file = "/var/lib/consul/secrets/ca.pem"
cert_file = "/var/lib/consul/secrets/cert.pem"
key_file = "/var/lib/consul/secrets/key.pem"
verify_incoming_https = false
verify_incoming_rpc = false
verify_outgoing = false

ports {
  http  = 8500
  https = 8501
}

# Gossip Encryption
encrypt = "{{ gossip_key }}"
encrypt_verify_incoming = true
encrypt_verify_outgoing = true

acl {
  enabled = true
  default_policy = "deny"
  enable_token_persistence = true

  tokens {
    #AGENT TOKEN HERE -- do not remove this line
  }
}

leave_on_terminate = true
disable_update_check = true

client_addr = "{{ bind_address }}"
bind_addr = "{{ bind_address }}"

#telemetry {
#  prometheus_retention_time = "60m"
#}

bootstrap_expect = 3
retry_join = [
{% for item in ip_list %}
 "{{ item }}"{{ "" if loop.last else ","}}
{% endfor %}
]
